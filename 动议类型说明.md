# MUN系统动议类型说明

## 十二种动议类型（Motion Types）

数据库中的 `motion_type` 字段已更新为 ENUM 类型，包含以下12种动议：

### 1. open_main_list
**开启主发言名单**
- 开启主要发言列表，允许代表按顺序发言

### 2. close_main_list
**关闭主发言名单**
- 关闭主要发言列表，停止接受新的发言申请

### 3. set_speaking_time
**设置发言时间**
- 设定每次发言的时间限制

### 4. moderated_caucus
**有组织核心磋商**
- 在主席主持下的结构化讨论

### 5. unmoderated_caucus
**自由磋商**
- 非正式讨论时间，代表可以自由交流

### 6. introduce_draft_resolution
**引入决议草案**
- 提交新的决议草案供讨论

### 7. introduce_amendment
**引入修正案**
- 对现有决议草案提出修改建议

### 8. vote_on_draft_resolution
**对决议草案投票**
- 对决议草案进行正式投票

### 9. vote_on_amendment
**对修正案投票**
- 对修正案进行正式投票

### 10. consultation_of_the_whole
**全体磋商**
- 全体代表参与的磋商会议

### 11. roll_call_vote
**唱名投票**
- 逐一点名进行投票，记录每位代表的投票

### 12. adjourn_meeting
**休会**
- 暂停或结束会议

## 技术实现说明

### 数据库结构
- **表名**: `Motions`
- **字段**: `motion_type ENUM(...)`
- **外键约束**: `proposer_id` 设置为 `ON DELETE SET NULL` 以避免空值错误

### API端点
- **POST /api/motions**: 创建动议记录
- **GET /api/display/sessions**: 获取会议历程（所有sessions）
- **GET /api/display/board**: 获取大屏显示数据

### 前端对接
所有动议类型都应该通过 API 端点发送，确保使用上述12个枚举值之一。

## 动议类型翻译映射

前后端在显示动议类型时都应使用中文名称。后端API已经在 `DisplayController::getBoard()` 中实现了翻译：

```php
$motionTypeNames = [
    'open_main_list' => '开启主发言名单',
    'close_main_list' => '关闭主发言名单',
    'set_speaking_time' => '设置发言时间',
    'moderated_caucus' => '有组织核心磋商',
    'unmoderated_caucus' => '自由磋商',
    'introduce_draft_resolution' => '引入决议草案',
    'introduce_amendment' => '引入修正案',
    'vote_on_draft_resolution' => '对决议草案投票',
    'vote_on_amendment' => '对修正案投票',
    'consultation_of_the_whole' => '全体磋商',
    'roll_call_vote' => '唱名投票',
    'adjourn_meeting' => '休会',
];
```

## 历史事件显示格式

会议历程中的历史事件现在按以下格式显示：

- **标题**: "动议通过：有组织核心磋商"
- **描述**: "中国动议了一个有组织核心磋商 · 单次2分钟 · 总时长30分钟"

## 更新日志
- 2025-11-23: 将 `motion_type` 从 VARCHAR(100) 更新为 ENUM 类型
- 2025-11-23: 修复了 proposer_id 的空值处理问题
- 2025-11-23: 添加了 GET /api/display/sessions 端点
- 2025-11-23: 更新了 API 文档（display.openapi.json）
- 2025-11-23: 实现动议类型中文翻译显示
- 2025-11-23: 修复添加发言者功能（返回完整delegate信息）
- 2025-11-23: 优化历史事件描述格式
